Version 4
SHEET 1 2040 680
WIRE 880 80 608 80
WIRE 0 96 0 64
WIRE 880 144 880 80
WIRE 608 160 416 160
WIRE 80 176 48 176
WIRE 128 176 80 176
WIRE 304 176 288 176
WIRE 352 176 304 176
WIRE 80 192 80 176
WIRE 432 192 416 192
WIRE 880 240 880 224
WIRE 880 240 608 240
WIRE 608 256 608 240
WIRE 0 272 0 192
WIRE 80 272 80 256
WIRE 80 272 0 272
WIRE 352 272 80 272
WIRE 432 272 432 192
WIRE 432 272 352 272
FLAG 0 352 0
FLAG 0 64 VSINK
FLAG 384 208 VCC
FLAG 384 144 0
FLAG 1184 208 0
FLAG 1392 208 0
FLAG 1184 128 VSINK
FLAG 1392 128 SP
FLAG 1088 208 0
FLAG 1088 128 VCC
FLAG 352 272 IN-
FLAG 608 256 0
FLAG 608 0 VCC
FLAG 1280 208 0
FLAG 304 176 fb
FLAG 208 176 g
DATAFLAG 192 272 "round($/1u)*1u"
DATAFLAG 432 160 "round($/1u)*1u"
SYMBOL res 16 256 M0
SYMATTR InstName R1
SYMATTR Value 5m
SYMBOL voltage 1184 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 2.5
SYMBOL voltage 1392 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(1m .999 0 1u 1u 100m 200m)
SYMBOL voltage 1088 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 5
SYMBOL res 592 -16 R0
SYMATTR InstName R2
SYMATTR Value 390k
SYMBOL nmos 48 96 M0
SYMATTR InstName M1
SYMATTR Value irfb7545pbf
SYMATTR Prefix X
SYMBOL res 592 64 R0
SYMATTR InstName R3
SYMATTR Value R = 10k*(1-V(SP))
SYMBOL res 592 144 R0
SYMATTR InstName R4
SYMATTR Value R = 10k*V(SP)
SYMBOL res 864 128 R0
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL voltage 304 176 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V4
SYMATTR Value ac 1
SYMBOL res 224 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL voltage 1280 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 1
SYMBOL OpAmps\\LT6220 384 176 R180
SYMATTR InstName U1
SYMBOL cap 64 192 R0
SYMATTR InstName C1
SYMATTR Value 330n
SYMATTR SpiceLine Rser=56
TEXT 632 328 Left 2 !.tran 0 1000m 0 10u startup uic
TEXT 120 328 Left 2 !.include irfb7545pbf.txt
TEXT 120 352 Left 2 !.include MCP6001.txt
TEXT 704 16 Left 2 ;R5 emulates digital\npotentiometer in parallel
TEXT 632 360 Left 2 !;ac dec 100 10 1G
TEXT 120 384 Left 2 ;.step param SP 1m 999m 1m
TEXT 120 416 Left 2 !.meas PM FIND V(fb)/V(g) WHEN mag(V(fb)/V(g)) = 1\n.meas GM FIND V(fb)/V(g) WHEN ph(V(fb)/V(g)) = 0
